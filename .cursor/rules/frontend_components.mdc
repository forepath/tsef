---
globs: "apps/frontend-*/**/*.component.ts, apps/frontend-*/**/*.component.html, apps/frontend-*/**/*.component.scss, libs/**/frontend/**/*.component.ts, libs/**/frontend/**/*.component.html, libs/**/frontend/**/*.component.scss"
alwaysApply: false
---

# Frontend Component Rules (Angular)

This ruleset governs Angular components and their templates/styles. It aligns with the repository's frontend guidelines and Nx monorepo practices.

> The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" are as described in RFC 2119.

## General

- Components **MUST** be presentational where possible and keep business logic out of the view layer.
- Components **MUST NOT** dispatch to the store or select state directly when a facade is available; use a domain facade from `data-access`.
- Components **SHOULD** be standalone and import only necessary modules.
- Templates **MUST** avoid complex logic; prefer pipes, pure functions, or computed values provided by facades.
- Styles **SHOULD** use SCSS and follow BEM or the projectâ€™s chosen convention.

## Inputs/Outputs

- `@Input()` and `@Output()` **MUST** be strongly typed.
- Components **SHOULD** use `ChangeDetectionStrategy.OnPush`.
- Event outputs **MUST** emit domain-specific payloads, not DOM events.

## Accessibility

- Templates **MUST** meet WCAG 2.1 AA where applicable (labels, roles, focus order, contrast).
- Interactive elements **MUST** be keyboard operable and expose ARIA attributes when needed.

## Testing

- Components **MUST** include unit tests covering rendering, bindings, and inputs/outputs.
- Components **SHOULD** avoid mocking facades excessively; prefer thin components with simple tests.

## Error Handling

- UI errors **SHOULD** be represented by dedicated states (loading, empty, error) and not encoded as thrown exceptions in templates.

## State Management (NgRx Alignment)

- Components **MUST NOT** access NgRx store directly; use facades from `data-access` libraries.
- Components **SHOULD** subscribe via `async` pipe; avoid manual subscriptions when possible.

## Examples

```ts
@Component({
  selector: 'app-user-card',
  standalone: true,
  changeDetection: ChangeDetectionStrategy.OnPush,
  templateUrl: './user-card.component.html',
})
export class UserCardComponent {
  @Input() user!: { id: string; name: string; email: string };
  @Output() selected = new EventEmitter<string>();
  onClick() { this.selected.emit(this.user.id); }
}
```

```html
<article
  (click)="onClick()"
  role="button"
  tabindex="0"
  aria-label="Select user {{ user.name }}"
>
  <h3>{{ user.name }}</h3>
  <p>{{ user.email }}</p>
  <!-- presentational only; no store access here -->
</article>
```
