<div class="terminal-container d-flex flex-column h-100">
  @if (sessionIds().length > 0) {
    <!-- Terminal Header -->
    <div class="terminal-header p-2 border-bottom bg-body-tertiary d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center gap-2">
        <i class="bi bi-terminal"></i>
        <div class="dropdown">
          <button
            class="btn btn-sm btn-outline-primary dropdown-toggle"
            type="button"
            id="terminalSessionDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            {{ getSessionName(activeSessionId() || '') }}
          </button>
          <ul class="dropdown-menu" aria-labelledby="terminalSessionDropdown">
            @for (sessionId of sessionIds(); track sessionId) {
              <li>
                <a
                  class="dropdown-item d-flex align-items-center justify-content-between"
                  [class.active]="activeSessionId() === sessionId"
                  (click)="onSwitchSession(sessionId, $event)"
                  href="#"
                >
                  <span>{{ getSessionName(sessionId) }}</span>
                  <button
                    type="button"
                    class="btn-close btn-close-sm ms-2 terminal-close-btn"
                    [class.active]="activeSessionId() === sessionId"
                    (click)="onCloseTerminal(sessionId, $event)"
                    aria-label="Close terminal"
                  ></button>
                </a>
              </li>
            }
          </ul>
        </div>
      </div>
      <div class="d-flex align-items-center gap-2">
        <button type="button" class="btn btn-sm btn-primary" (click)="onCreateTerminal()" title="New Terminal">
          <i class="bi bi-plus-circle me-1"></i>
          New
        </button>
      </div>
    </div>
  }

  <!-- Terminal Content - Always render when visible to ensure ViewChild is available -->
  <div class="terminal-content flex-grow-1 position-relative" #terminalContainer>
    @if (sessionIds().length === 0) {
      <!-- Placeholder when no terminal sessions -->
      <div
        class="d-flex justify-content-center align-items-center h-100 bg-body-secondary position-absolute top-0 start-0 w-100 h-100"
      >
        <div class="text-center text-muted p-4">
          <i class="bi bi-terminal fs-1 d-block mb-3"></i>
          <p class="mb-0">No terminal session</p>
          <small class="text-muted">Click "New" to create a terminal session</small>
          <div class="mt-3">
            <button type="button" class="btn btn-sm btn-primary" (click)="onCreateTerminal()">
              <i class="bi bi-plus-circle me-1"></i>
              New Terminal
            </button>
          </div>
        </div>
      </div>
    }
  </div>
</div>
