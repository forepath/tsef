openapi: 3.1.0
info:
  title: Agent Manager API
  version: 1.0.0
  description: HTTP API for managing agents
  contact:
    name: ForePath
    email: hi@forepath.io
    url: https://forepath.io
servers:
  - url: http://localhost:3000/api
    description: Local development
security:
  - bearerAuth: []
paths:
  /agents:
    get:
      summary: List agents
      operationId: listAgents
      parameters:
        - in: query
          name: limit
          schema:
            type: integer
            minimum: 0
          description: Maximum number of agents to return (default 10)
        - in: query
          name: offset
          schema:
            type: integer
            minimum: 0
          description: Number of agents to skip (default 0)
      responses:
        '200':
          description: Array of agents
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AgentResponseDto'
    post:
      summary: Create agent
      operationId: createAgent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAgentDto'
      responses:
        '201':
          description: Created agent with generated password
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateAgentResponseDto'
  /agents/{id}:
    get:
      summary: Get agent by id
      operationId: getAgent
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Agent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentResponseDto'
    post:
      summary: Update agent
      operationId: updateAgent
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAgentDto'
      responses:
        '200':
          description: Updated agent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentResponseDto'
    delete:
      summary: Delete agent
      operationId: deleteAgent
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Deleted
  /config:
    get:
      summary: Get configuration parameters
      operationId: getConfig
      responses:
        '200':
          description: Configuration parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigResponseDto'
  /agents/{agentId}/files:
    get:
      summary: List directory contents
      operationId: listDirectory
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: query
          name: path
          schema:
            type: string
          description: Directory path relative to /app (defaults to '.')
      responses:
        '200':
          description: Array of file nodes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FileNodeDto'
        '404':
          description: Agent or directory not found
  /agents/{agentId}/files/{path}:
    get:
      summary: Read file content
      operationId: readFile
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: path
          required: true
          schema:
            type: string
          description: File path relative to /app (supports nested paths)
      responses:
        '200':
          description: File content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileContentDto'
        '400':
          description: Invalid path
        '404':
          description: Agent or file not found
    post:
      summary: Create file or directory
      operationId: createFileOrDirectory
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: path
          required: true
          schema:
            type: string
          description: File or directory path relative to /app (supports nested paths)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateFileDto'
      responses:
        '201':
          description: File or directory created
        '400':
          description: Invalid request
        '404':
          description: Agent not found
    put:
      summary: Write file content
      operationId: writeFile
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: path
          required: true
          schema:
            type: string
          description: File path relative to /app (supports nested paths)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WriteFileDto'
      responses:
        '204':
          description: File written successfully
        '400':
          description: Invalid path or content too large
        '404':
          description: Agent not found
    delete:
      summary: Delete file or directory
      operationId: deleteFileOrDirectory
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: path
          required: true
          schema:
            type: string
          description: File or directory path relative to /app (supports nested paths)
      responses:
        '204':
          description: File or directory deleted successfully
        '400':
          description: Invalid path
        '404':
          description: Agent or file/directory not found
    patch:
      summary: Move file or directory
      operationId: moveFileOrDirectory
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: path
          required: true
          schema:
            type: string
          description: Source file or directory path relative to /app (supports nested paths)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MoveFileDto'
      responses:
        '204':
          description: File or directory moved successfully
        '400':
          description: Invalid path or destination
        '404':
          description: Agent or source file/directory not found
  /agents/{agentId}/environment:
    get:
      summary: List environment variables
      operationId: listEnvironmentVariables
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: query
          name: limit
          schema:
            type: integer
            minimum: 0
          description: Maximum number of environment variables to return (default 50)
        - in: query
          name: offset
          schema:
            type: integer
            minimum: 0
          description: Number of environment variables to skip (default 0)
      responses:
        '200':
          description: Array of environment variables
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EnvironmentVariableResponseDto'
        '404':
          description: Agent not found
    post:
      summary: Create environment variable
      operationId: createEnvironmentVariable
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateEnvironmentVariableDto'
      responses:
        '201':
          description: Environment variable created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnvironmentVariableResponseDto'
        '400':
          description: Invalid request
        '404':
          description: Agent not found
    delete:
      summary: Delete all environment variables
      operationId: deleteAllEnvironmentVariables
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: All environment variables deleted
          content:
            application/json:
              schema:
                type: object
                required: [deletedCount]
                properties:
                  deletedCount:
                    type: integer
                    description: Number of environment variables deleted
        '404':
          description: Agent not found
  /agents/{agentId}/environment/count:
    get:
      summary: Get count of environment variables
      operationId: countEnvironmentVariables
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Count of environment variables
          content:
            application/json:
              schema:
                type: object
                required: [count]
                properties:
                  count:
                    type: integer
                    description: Total count of environment variables for the agent
        '404':
          description: Agent not found
  /agents/{agentId}/environment/{id}:
    put:
      summary: Update environment variable
      operationId: updateEnvironmentVariable
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateEnvironmentVariableDto'
      responses:
        '200':
          description: Environment variable updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnvironmentVariableResponseDto'
        '400':
          description: Invalid request
        '404':
          description: Agent or environment variable not found
    delete:
      summary: Delete environment variable
      operationId: deleteEnvironmentVariable
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Environment variable deleted
        '404':
          description: Agent or environment variable not found
  /agents/{agentId}/vcs/status:
    get:
      summary: Get git status
      operationId: getGitStatus
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Git status information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GitStatusDto'
        '404':
          description: Agent not found
  /agents/{agentId}/vcs/branches:
    get:
      summary: List all branches
      operationId: getGitBranches
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Array of branch information
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/GitBranchDto'
        '404':
          description: Agent not found
    post:
      summary: Create a new branch
      operationId: createGitBranch
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateBranchDto'
      responses:
        '201':
          description: Branch created successfully
        '400':
          description: Invalid branch name or parameters
        '404':
          description: Agent not found
  /agents/{agentId}/vcs/branches/{branch}:
    delete:
      summary: Delete a branch
      operationId: deleteGitBranch
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: branch
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Branch deleted successfully
        '400':
          description: Cannot delete current branch
        '404':
          description: Agent or branch not found
  /agents/{agentId}/vcs/branches/{branch}/switch:
    post:
      summary: Switch to a branch
      operationId: switchGitBranch
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: branch
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Branch switched successfully
        '400':
          description: Invalid branch or uncommitted changes
        '404':
          description: Agent or branch not found
  /agents/{agentId}/vcs/diff:
    get:
      summary: Get file diff
      operationId: getGitFileDiff
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: query
          name: path
          required: true
          schema:
            type: string
          description: File path relative to repository root
      responses:
        '200':
          description: File diff information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GitDiffDto'
        '400':
          description: Invalid file path
        '404':
          description: Agent or file not found
  /agents/{agentId}/vcs/stage:
    post:
      summary: Stage files
      operationId: stageFiles
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StageFilesDto'
      responses:
        '204':
          description: Files staged successfully
        '400':
          description: Invalid file paths
        '404':
          description: Agent not found
  /agents/{agentId}/vcs/unstage:
    post:
      summary: Unstage files
      operationId: unstageFiles
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UnstageFilesDto'
      responses:
        '204':
          description: Files unstaged successfully
        '400':
          description: Invalid file paths
        '404':
          description: Agent not found
  /agents/{agentId}/vcs/commit:
    post:
      summary: Commit staged changes
      operationId: commitChanges
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommitDto'
      responses:
        '204':
          description: Changes committed successfully
        '400':
          description: No staged changes or invalid commit message
        '404':
          description: Agent not found
  /agents/{agentId}/vcs/push:
    post:
      summary: Push changes to remote
      operationId: pushChanges
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PushOptionsDto'
      responses:
        '204':
          description: Changes pushed successfully
        '400':
          description: Nothing to push or push failed
        '404':
          description: Agent not found
  /agents/{agentId}/vcs/pull:
    post:
      summary: Pull changes from remote
      operationId: pullChanges
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Changes pulled successfully
        '400':
          description: Pull failed or conflicts
        '404':
          description: Agent not found
  /agents/{agentId}/vcs/fetch:
    post:
      summary: Fetch changes from remote
      operationId: fetchChanges
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Changes fetched successfully
        '404':
          description: Agent not found
  /agents/{agentId}/vcs/rebase:
    post:
      summary: Rebase current branch
      operationId: rebaseBranch
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RebaseDto'
      responses:
        '204':
          description: Rebase completed successfully
        '400':
          description: Rebase failed or conflicts
        '404':
          description: Agent or branch not found
  /agents/{agentId}/vcs/conflicts/resolve:
    post:
      summary: Resolve merge conflict
      operationId: resolveConflict
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResolveConflictDto'
      responses:
        '204':
          description: Conflict resolved successfully
        '400':
          description: Invalid conflict resolution strategy
        '404':
          description: Agent or file not found
  /agents/{agentId}/deployments/configuration:
    get:
      summary: Get deployment configuration for an agent
      operationId: getDeploymentConfiguration
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Deployment configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeploymentConfigurationResponseDto'
        '404':
          description: Agent or deployment configuration not found
    post:
      summary: Create or update deployment configuration for an agent
      operationId: upsertDeploymentConfiguration
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDeploymentConfigurationDto'
      responses:
        '200':
          description: Deployment configuration created or updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeploymentConfigurationResponseDto'
        '400':
          description: Invalid request
        '404':
          description: Agent not found
    delete:
      summary: Delete deployment configuration for an agent
      operationId: deleteDeploymentConfiguration
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Deployment configuration deleted successfully
        '404':
          description: Agent or deployment configuration not found
  /agents/{agentId}/deployments/repositories:
    get:
      summary: List repositories accessible with the agent's deployment configuration
      operationId: listDeploymentRepositories
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Array of repositories
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RepositoryResponseDto'
        '404':
          description: Agent or deployment configuration not found
  /agents/{agentId}/deployments/repositories/{repositoryId}/branches:
    get:
      summary: List branches for a repository
      operationId: listDeploymentBranches
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: repositoryId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Array of branches
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/BranchResponseDto'
        '404':
          description: Agent or deployment configuration not found
  /agents/{agentId}/deployments/repositories/{repositoryId}/workflows:
    get:
      summary: List workflows for a repository
      operationId: listDeploymentWorkflows
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: repositoryId
          required: true
          schema:
            type: string
        - in: query
          name: branch
          schema:
            type: string
          description: Branch name (optional, defaults to default branch)
      responses:
        '200':
          description: Array of workflows
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/WorkflowResponseDto'
        '404':
          description: Agent or deployment configuration not found
  /agents/{agentId}/deployments/workflows/trigger:
    post:
      summary: Trigger a workflow run
      operationId: triggerDeploymentWorkflow
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TriggerWorkflowDto'
      responses:
        '200':
          description: Workflow run triggered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeploymentRunResponseDto'
        '400':
          description: Invalid request
        '404':
          description: Agent or deployment configuration not found
  /agents/{agentId}/deployments/runs:
    get:
      summary: List deployment runs for an agent
      operationId: listDeploymentRuns
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: query
          name: limit
          schema:
            type: integer
            minimum: 0
          description: Maximum number of runs to return (default 50)
        - in: query
          name: offset
          schema:
            type: integer
            minimum: 0
          description: Number of runs to skip (default 0)
      responses:
        '200':
          description: Array of deployment runs
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DeploymentRunResponseDto'
        '404':
          description: Agent or deployment configuration not found
  /agents/{agentId}/deployments/runs/{runId}:
    get:
      summary: Get the status of a pipeline run
      operationId: getDeploymentRunStatus
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: runId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Pipeline run status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeploymentRunResponseDto'
        '404':
          description: Agent, deployment configuration, or run not found
  /agents/{agentId}/deployments/runs/{runId}/logs:
    get:
      summary: Get logs for a pipeline run
      operationId: getDeploymentRunLogs
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: runId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Pipeline run logs
          content:
            application/json:
              schema:
                type: object
                required: [logs]
                properties:
                  logs:
                    type: string
                    description: Pipeline run logs as string
        '404':
          description: Agent, deployment configuration, or run not found
  /agents/{agentId}/deployments/runs/{runId}/jobs:
    get:
      summary: List jobs/steps for a pipeline run
      operationId: listDeploymentRunJobs
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: runId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Array of jobs/steps
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/JobResponseDto'
        '404':
          description: Agent, deployment configuration, or run not found
  /agents/{agentId}/deployments/runs/{runId}/jobs/{jobId}/logs:
    get:
      summary: Get logs for a specific job/step
      operationId: getDeploymentJobLogs
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: runId
          required: true
          schema:
            type: string
        - in: path
          name: jobId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Job logs
          content:
            application/json:
              schema:
                type: object
                required: [logs]
                properties:
                  logs:
                    type: string
                    description: Job logs as string
        '404':
          description: Agent, deployment configuration, run, or job not found
  /agents/{agentId}/deployments/runs/{runId}/cancel:
    post:
      summary: Cancel a running pipeline
      operationId: cancelDeploymentRun
      parameters:
        - in: path
          name: agentId
          required: true
          schema:
            type: string
            format: uuid
        - in: path
          name: runId
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Pipeline cancelled successfully
        '404':
          description: Agent, deployment configuration, or run not found
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    CreateAgentDto:
      type: object
      required: [name]
      properties:
        name:
          type: string
        description:
          type: [string, 'null']
        agentType:
          type: string
          enum: [cursor]
          description: Agent provider type (defaults to 'cursor' if not provided)
        gitRepositoryUrl:
          type: [string, 'null']
          description: Git repository URL to clone when creating the agent
        createVirtualWorkspace:
          type: boolean
          default: true
          description: Whether to create a VNC virtual workspace container (defaults to true)
        createSshConnection:
          type: boolean
          default: true
          description: Whether to create an SSH connection container (defaults to true)
        deploymentConfiguration:
          type: object
          description: CI/CD deployment configuration (optional). If provided, a deployment configuration will be created for this agent.
          properties:
            providerType:
              type: string
              description: CI/CD provider type (e.g., 'github')
            repositoryId:
              type: string
              description: Repository identifier (e.g., 'owner/repo' for GitHub)
            defaultBranch:
              type: string
              description: Default branch name
            workflowId:
              type: string
              description: Workflow/pipeline identifier
            providerToken:
              type: string
              description: Provider-specific API token/credentials
            providerBaseUrl:
              type: string
              format: uri
              description: Optional base URL for self-hosted instances (e.g., GitHub Enterprise Server)
    UpdateAgentDto:
      type: object
      properties:
        name:
          type: [string, 'null']
        description:
          type: [string, 'null']
        agentType:
          type: string
          enum: [cursor]
          description: Agent provider type
        deploymentConfiguration:
          type: object
          description: CI/CD deployment configuration (optional). If provided, the deployment configuration for this agent will be updated or created.
          properties:
            providerType:
              type: string
              description: CI/CD provider type (e.g., 'github')
            repositoryId:
              type: string
              description: Repository identifier (e.g., 'owner/repo' for GitHub)
            defaultBranch:
              type: string
              description: Default branch name
            workflowId:
              type: string
              description: Workflow/pipeline identifier
            providerToken:
              type: string
              description: Provider-specific API token/credentials
            providerBaseUrl:
              type: string
              format: uri
              description: Optional base URL for self-hosted instances (e.g., GitHub Enterprise Server)
    AgentResponseDto:
      type: object
      required: [id, name, agentType, createdAt, updatedAt]
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: [string, 'null']
        agentType:
          type: string
          description: Agent provider type identifier
        git:
          type: [object, 'null']
          properties:
            repositoryUrl:
              type: string
              description: Git repository URL associated with the agent
          description: Git information (only present if gitRepositoryUrl is set)
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    CreateAgentResponseDto:
      allOf:
        - $ref: '#/components/schemas/AgentResponseDto'
        - type: object
          required: [password]
          properties:
            password:
              type: string
    AgentTypeInfo:
      type: object
      required: [type, displayName]
      properties:
        type:
          type: string
          description: The unique type identifier (e.g., 'cursor', 'openai', 'anthropic')
        displayName:
          type: string
          description: Human-readable display name (e.g., 'Cursor', 'OpenAI', 'Anthropic Claude')
    ConfigResponseDto:
      type: object
      required: [agentTypes]
      properties:
        gitRepositoryUrl:
          type: [string, 'null']
          description: Git repository URL used for cloning repositories when creating agents
        agentTypes:
          type: array
          items:
            $ref: '#/components/schemas/AgentTypeInfo'
          description: Array of available agent provider types with display names
    FileContentDto:
      type: object
      required: [content, encoding]
      properties:
        content:
          type: string
          description: File content as base64-encoded string (supports both text and binary files)
        encoding:
          type: string
          enum: [utf-8, base64]
          description: Encoding indicator - 'utf-8' for text files, 'base64' for binary files
    FileNodeDto:
      type: object
      required: [name, type, path]
      properties:
        name:
          type: string
          description: File or directory name
        type:
          type: string
          enum: [file, directory]
          description: Node type
        path:
          type: string
          description: Relative path from /app
        size:
          type: [integer, 'null']
          description: File size in bytes (only for files)
        modifiedAt:
          type: [string, 'null']
          format: date-time
          description: Last modification timestamp
    WriteFileDto:
      type: object
      required: [content]
      properties:
        content:
          type: string
          description: File content as base64-encoded string (supports both text and binary files)
        encoding:
          type: string
          enum: [utf-8, base64]
          description: Optional encoding indicator - 'utf-8' for text files, 'base64' for binary files (defaults to 'utf-8')
    CreateFileDto:
      type: object
      required: [type]
      properties:
        type:
          type: string
          enum: [file, directory]
          description: Type of node to create
        content:
          type: [string, 'null']
          description: Optional content for file creation
    MoveFileDto:
      type: object
      required: [destination]
      properties:
        destination:
          type: string
          description: Destination path relative to /app (supports nested paths)
    GitStatusDto:
      type: object
      required:
        [
          currentBranch,
          isClean,
          hasUnpushedCommits,
          aheadCount,
          behindCount,
          files,
        ]
      properties:
        currentBranch:
          type: string
          description: Current branch name
        isClean:
          type: boolean
          description: Whether the working tree is clean (no changes)
        hasUnpushedCommits:
          type: boolean
          description: Whether there are unpushed commits (ahead of remote)
        aheadCount:
          type: integer
          description: Number of commits ahead of remote
        behindCount:
          type: integer
          description: Number of commits behind remote
        files:
          type: array
          items:
            $ref: '#/components/schemas/GitFileStatusDto'
          description: List of files with their git status
    GitFileStatusDto:
      type: object
      required: [path, status, type]
      properties:
        path:
          type: string
          description: File path relative to repository root
        status:
          type: string
          description: Git status code (e.g., 'M', 'A', 'D', '??', 'MM', etc.)
        type:
          type: string
          enum: [staged, unstaged, untracked, both]
          description: Status type
        isBinary:
          type: boolean
          description: Whether this is a binary file
        size:
          type: integer
          description: File size in bytes (for binary files)
    GitBranchDto:
      type: object
      required: [name, ref, isCurrent, isRemote, commit, message]
      properties:
        name:
          type: string
          description: Branch name (without refs/heads/ prefix)
        ref:
          type: string
          description: Full branch reference (e.g., 'refs/heads/main')
        isCurrent:
          type: boolean
          description: Whether this is the current branch
        isRemote:
          type: boolean
          description: Whether this is a remote branch
        remote:
          type: string
          description: Remote name (if remote branch)
        commit:
          type: string
          description: Commit hash (short)
        message:
          type: string
          description: Commit message (first line)
        aheadCount:
          type: integer
          description: Number of commits ahead of remote (for local branches)
        behindCount:
          type: integer
          description: Number of commits behind remote (for local branches)
    GitDiffDto:
      type: object
      required: [path, originalContent, modifiedContent, encoding, isBinary]
      properties:
        path:
          type: string
          description: File path relative to repository root
        originalContent:
          type: string
          description: Original file content (base64-encoded for text, empty for binary)
        modifiedContent:
          type: string
          description: Modified file content (base64-encoded for text, empty for binary)
        encoding:
          type: string
          enum: [utf-8, base64]
          description: Encoding indicator
        isBinary:
          type: boolean
          description: Whether this is a binary file
        originalSize:
          type: integer
          description: Original file size in bytes (for binary files)
        modifiedSize:
          type: integer
          description: Modified file size in bytes (for binary files)
    StageFilesDto:
      type: object
      required: [files]
      properties:
        files:
          type: array
          items:
            type: string
          description: Array of file paths to stage (empty array stages all)
    UnstageFilesDto:
      type: object
      required: [files]
      properties:
        files:
          type: array
          items:
            type: string
          description: Array of file paths to unstage (empty array unstages all)
    CommitDto:
      type: object
      required: [message]
      properties:
        message:
          type: string
          description: Commit message
    PushOptionsDto:
      type: object
      properties:
        force:
          type: boolean
          description: >
            When true, performs a `git push --force-with-lease`. Defaults to false.
    CreateBranchDto:
      type: object
      required: [name]
      properties:
        name:
          type: string
          description: Branch name (will be prefixed with conventional commit prefix if useConventionalPrefix is true)
        useConventionalPrefix:
          type: boolean
          description: Whether to use conventional commit prefix (feat/, fix/, chore/, etc.)
        conventionalType:
          type: string
          enum: [feat, fix, chore, docs, style, refactor, test, perf]
          description: Conventional commit type (only used if useConventionalPrefix is true)
        baseBranch:
          type: string
          description: Base branch to create from (defaults to current branch)
    RebaseDto:
      type: object
      required: [branch]
      properties:
        branch:
          type: string
          description: Branch name to rebase onto
    ResolveConflictDto:
      type: object
      required: [path, strategy]
      properties:
        path:
          type: string
          description: File path with conflict (relative to repository root)
        strategy:
          type: string
          enum: [yours, mine, both]
          description: Merge strategy - 'yours' (accept incoming), 'mine' (accept current), 'both' (keep both)
    CreateDeploymentConfigurationDto:
      type: object
      required: [providerType, repositoryId, providerToken]
      properties:
        providerType:
          type: string
          description: CI/CD provider type (e.g., 'github')
        repositoryId:
          type: string
          description: Repository identifier (e.g., 'owner/repo' for GitHub)
        defaultBranch:
          type: string
          description: Default branch name
        workflowId:
          type: string
          description: Workflow/pipeline identifier
        providerToken:
          type: string
          description: Provider-specific API token/credentials
        providerBaseUrl:
          type: string
          format: uri
          description: Optional base URL for self-hosted instances (e.g., GitHub Enterprise Server)
    UpdateDeploymentConfigurationDto:
      type: object
      properties:
        repositoryId:
          type: string
          description: Repository identifier (e.g., 'owner/repo' for GitHub)
        defaultBranch:
          type: string
          description: Default branch name
        workflowId:
          type: string
          description: Workflow/pipeline identifier
        providerToken:
          type: string
          description: Provider-specific API token/credentials
        providerBaseUrl:
          type: string
          format: uri
          description: Optional base URL for self-hosted instances (e.g., GitHub Enterprise Server)
    DeploymentConfigurationResponseDto:
      type: object
      required: [id, agentId, providerType, repositoryId, createdAt, updatedAt]
      properties:
        id:
          type: string
          format: uuid
        agentId:
          type: string
          format: uuid
        providerType:
          type: string
          description: CI/CD provider type (e.g., 'github')
        repositoryId:
          type: string
          description: Repository identifier (e.g., 'owner/repo' for GitHub)
        defaultBranch:
          type: string
          description: Default branch name
        workflowId:
          type: string
          description: Workflow/pipeline identifier
        providerBaseUrl:
          type: string
          format: uri
          description: Optional base URL for self-hosted instances
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    TriggerWorkflowDto:
      type: object
      required: [workflowId, ref]
      properties:
        workflowId:
          type: string
          description: Workflow/pipeline identifier
        ref:
          type: string
          description: Git reference (branch, tag, or commit SHA)
        inputs:
          type: object
          additionalProperties:
            type: string
          description: Optional workflow inputs
    DeploymentRunResponseDto:
      type: object
      required:
        [
          id,
          configurationId,
          providerRunId,
          runName,
          status,
          ref,
          sha,
          createdAt,
          updatedAt,
        ]
      properties:
        id:
          type: string
          format: uuid
        configurationId:
          type: string
          format: uuid
        providerRunId:
          type: string
          description: Provider-specific run identifier
        runName:
          type: string
          description: Run name/title
        status:
          type: string
          enum: [queued, in_progress, completed, cancelled, failure]
          description: Run status
        conclusion:
          type: string
          enum: [success, failure, cancelled, skipped]
          description: Run conclusion
        ref:
          type: string
          description: Git reference (branch, tag, or commit SHA)
        sha:
          type: string
          description: Commit SHA
        workflowId:
          type: string
          description: Workflow that triggered this run
        workflowName:
          type: string
          description: Workflow name
        startedAt:
          type: string
          format: date-time
          description: When the run started
        completedAt:
          type: string
          format: date-time
          description: When the run completed
        htmlUrl:
          type: string
          format: uri
          description: HTML URL for viewing the run
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    RepositoryResponseDto:
      type: object
      required: [id, name, fullName, defaultBranch, url, private]
      properties:
        id:
          type: string
          description: Repository identifier (e.g., 'owner/repo' for GitHub)
        name:
          type: string
          description: Repository name
        fullName:
          type: string
          description: Repository full name (e.g., 'owner/repo')
        defaultBranch:
          type: string
          description: Default branch name
        url:
          type: string
          format: uri
          description: Repository URL
        private:
          type: boolean
          description: Whether the repository is private
    BranchResponseDto:
      type: object
      required: [name, sha, default]
      properties:
        name:
          type: string
          description: Branch name
        sha:
          type: string
          description: Commit SHA
        default:
          type: boolean
          description: Whether this is the default branch
    WorkflowResponseDto:
      type: object
      required: [id, name, path, state, canTrigger]
      properties:
        id:
          type: string
          description: Workflow identifier
        name:
          type: string
          description: Workflow name
        path:
          type: string
          description: Workflow file path (e.g., '.github/workflows/deploy.yml')
        state:
          type: string
          description: Workflow state (e.g., 'active', 'disabled')
        canTrigger:
          type: boolean
          description: Whether the workflow can be manually triggered
    JobResponseDto:
      type: object
      required: [id, name, status]
      properties:
        id:
          type: string
          description: Job identifier
        name:
          type: string
          description: Job name
        status:
          type: string
          enum: [queued, in_progress, completed, cancelled, failure]
          description: Job status
        conclusion:
          type: string
          enum: [success, failure, cancelled, skipped]
          description: Job conclusion
        startedAt:
          type: string
          format: date-time
          description: When the job started
        completedAt:
          type: string
          format: date-time
          description: When the job completed
    CreateEnvironmentVariableDto:
      type: object
      required: [variable, content]
      properties:
        variable:
          type: string
          description: Environment variable name
        content:
          type: string
          description: Environment variable content
    UpdateEnvironmentVariableDto:
      type: object
      required: [variable, content]
      properties:
        variable:
          type: string
          description: Environment variable name
        content:
          type: string
          description: Environment variable content
    EnvironmentVariableResponseDto:
      type: object
      required: [id, agentId, variable, content, createdAt, updatedAt]
      properties:
        id:
          type: string
          format: uuid
        agentId:
          type: string
          format: uuid
        variable:
          type: string
          description: Environment variable name
        content:
          type: string
          description: Environment variable content
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
